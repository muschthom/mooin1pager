define("format_mooin1pager/lib",["jquery","core/ajax","core/notification"],(function($,Ajax,Notification){function updateProgressBar(courseId){setTimeout((()=>{Ajax.call([{methodname:"format_mooin1pager_execute",args:{courseid:courseId}}])[0].then((result=>{console.log("AJAX Call Result:",result);const curr=result.courseprogress,container=document.querySelector(".progress-container");if(container){const innerBar=container.querySelector(".progressbar-inner"),percentSpan=container.querySelector(".font-weight-bold");innerBar&&(innerBar.style.width="".concat(curr,"%")),percentSpan&&(percentSpan.textContent="".concat(curr,"%"))}})).catch((error=>{Notification.exception(error)}))}),500)}return{updateProgressBar:updateProgressBar,hvpListener:function(){document.querySelectorAll("iframe").forEach((parentIFrame=>{try{const doc=parentIFrame.contentDocument||parentIFrame.contentWindow.document;let nestedIFrame=null;const adjust=()=>setTimeout((()=>{var _nestedIFrame,_nestedIFrame$content;if(nestedIFrame=nestedIFrame||doc.querySelector(".h5p-iframe"),null!==(_nestedIFrame=nestedIFrame)&&void 0!==_nestedIFrame&&null!==(_nestedIFrame$content=_nestedIFrame.contentWindow)&&void 0!==_nestedIFrame$content&&_nestedIFrame$content.document){const h=nestedIFrame.contentWindow.document.body.scrollHeight;h>1&&(parentIFrame.style.height="".concat(h,"px"))}}),100),checkH5P=()=>{if(nestedIFrame=nestedIFrame||doc.querySelector(".h5p-iframe"),nestedIFrame){var _pw$H5P;const pw=nestedIFrame.contentWindow;if(null!==(_pw$H5P=pw.H5P)&&void 0!==_pw$H5P&&_pw$H5P.externalDispatcher)return console.log("H5P gefunden"),pw.H5P.externalDispatcher.on("xAPI",(event=>{updateProgressBar(M.cfg.courseId||document.body.dataset.courseid)})),adjust(),!0}return!1};if(!checkH5P()){const mo=new MutationObserver((()=>{checkH5P()&&mo.disconnect()}));mo.observe(doc.body,{childList:!0,subtree:!0})}}catch(err){console.error("Fehler in HVP Listener:",err)}}))}}}));

//# sourceMappingURL=lib.min.js.map